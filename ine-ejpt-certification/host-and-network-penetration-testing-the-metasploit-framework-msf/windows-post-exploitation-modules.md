# Windows Post Exploitation Modules

* The MSF provides us with various post exploiation modules for both Windows and Linux.
* We can utilize these post exploitation modules to enumerate information about the Windows system we are currently have access to:
  * <mark style="color:blue;">Enumerate user priviliges</mark>
  * <mark style="color:blue;">Enumerate logged on users</mark>
  * <mark style="color:blue;">VM check</mark>
  * <mark style="color:blue;">Enumerate installed programs</mark>
  * <mark style="color:blue;">Enumerate AVs</mark>
  * <mark style="color:blue;">Enumerate computers connected to domain</mark>
  * <mark style="color:blue;">Enumerate installed patches</mark>
  * <mark style="color:blue;">Enumerate shares</mark>

## Practice Demo

Start database and open msf

Create workspace and create global variables

Enumerate the target:

* <mark style="color:yellow;">db\_nmap -sV targetIP</mark>

<figure><img src="../../.gitbook/assets/image (61).png" alt=""><figcaption></figcaption></figure>

We will exploit the rejetto file server

* <mark style="color:yellow;">exploit/windows/http/rejetto\_hfs\_exec</mark>

This gives us a meterpreter session

### Windows Post Exploitation Modules

* <mark style="color:yellow;">post/windows/gather/win\_privs:</mark> Enumerates privs of current user of defined session
* <mark style="color:yellow;">post/windows/gather/enum\_logged\_on\_users</mark>: Enumerates any previously/still logged on users
* <mark style="color:yellow;">post/windows/gather/checkvm</mark>: Checks if target is a VM
* <mark style="color:yellow;">post/windows/gather/enum\_applications</mark>: Eumerates the  programs installed on the target
* <mark style="color:yellow;">post/windows/gather/enum\_av\_excluded</mark>: Enumerates excluded folders not being scanned and if and what AV is active
* <mark style="color:yellow;">post/windows/gather/enum\_computers</mark>: Enumerates computers that are part of a domain
* <mark style="color:yellow;">post/windows/gather/enum\_patches</mark>: Enumerates what patches have been installed on a target system
  * We can also do this by going into the meterpreter session, moving to a shell, and running "<mark style="color:red;">systeminfo</mark>".
* <mark style="color:yellow;">post/windows/gather/enum\_shares</mark>: Enumerates any shares on the domain
* <mark style="color:yellow;">post/windows/manage/enable\_rdp</mark>: Tries to enable rdp, but also tells you if it is already enabled
