# Linux Privilege Escalation: Exploiting A Vulnerable Program

## Linux Privilege Escalation

* The privilege escalation techniques we can utilize will depend on the version of the Linux kernel running on the target system a well as the distribuiton release version.
* MSF offers very little in regards to Linux kernel exploit modules, however, in some cases, there may be an exploit module that can be utilized to exploit a vulnerable service or program in order to elevate our privileges.

## Practice Demo

Enumerate the target

In this case we have the credentials to login through ssh.

Use the <mark style="color:red;">ssh\_login</mark> module.

We upgrade the session to a meterpreter with:

* <mark style="color:yellow;">sessions -u 1</mark>

### Identify the vulnerable program

Enumerate current processes with:

* <mark style="color:yellow;">ps aux</mark>

<figure><img src="../../.gitbook/assets/image (63).png" alt=""><figcaption></figcaption></figure>

In this case we identify that the root user is running a process <mark style="color:red;">PID:33,</mark> that runs a script in the /bin directory.

<figure><img src="../../.gitbook/assets/image (64).png" alt=""><figcaption></figcaption></figure>

In the script "<mark style="color:red;">chkrootkit</mark>" is being ran every 60 seconds. This binary is vulnerable to a local privesc vuln before version 0.50,

Enumerate the version of chkrootkit:

* <mark style="color:yellow;">chkrootkit -V</mark>

### Exploiting chkrookit

Used module:

* <mark style="color:yellow;">exploit/unix/local/chkrootkit:</mark> In versions before 0.50, chkrookit runs any executable named /<mark style="color:red;">tmp/update</mark> as root, allowing for priv esc.

Set payload and session

Set the path to the chkrookit binary.
