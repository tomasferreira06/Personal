# Pivoting

* Pivoting is a post exploitation technique that involves utilizing a compromised host that is connected to multiple networks to gain access to systems within other networks.
* After gaining access to one host, we can use the compromised host to exploit other hosts on a private internal network to which we could not access previously.
* Meterpreter provides us with the ability to add a network route to the internal network's subnet, perform port forwarding and consequently scan and exploit other systems on the  network.

## Port Forwarding

Port forwarding is the process of redirecting traffic from a specific port on a target system to a specific port on our system.

In the context of pivoting, we can forward a remote port on a previously inaccessible host to a local port on our Kali Linux system so that we can remotely interact/exploit the service running on the port.

## Pivoting Visualized

<figure><img src="../../.gitbook/assets/image (167).png" alt=""><figcaption></figcaption></figure>

## Practice Demo

Enumerate first target.

We identify rejetto http file server.

We gain a 32bit meterpreter session as an admin user.

### Scanning for other systems on the target network

#### Adding route to the entire subnet

* <mark style="color:yellow;">run autoroute -s networkaddress'/CIDRnotation</mark>

#### Display active routes

* <mark style="color:yellow;">run autoroute -p</mark>

#### Performing a scan on the second target

* <mark style="color:yellow;">auxiliary/scanner/portscan/tcp</mark>

We identify port 80 open on the second target.

To be able to scan the second target using nmap, we need to set up <mark style="color:red;">port forwarding</mark>.

* <mark style="color:yellow;">portfwd add -l 1234 -p 80 -r 'targetIP'</mark>

#### Performing the nmap scan

* <mark style="color:yellow;">nmap -sV -p 1234 localhost</mark>

We identify the BadBlue service on port 80

In this case we will set the "<mark style="color:red;">bind/tcp" payload</mark>, not the reverse shell.
