# Dumping & Cracking Linux Password Hashes

## Linux Password Hashes

Linux has multi-user support and as a result, multiple users can access the system simultaneously. This can be seen as both an advantage and disadvantage from a security perspective, in that, multiple accounts offer multiple access vectors for attackers and therefore increase the overall risk of the server.

All the information for all accounts on Linux is stored in the passwd file located in: <mark style="color:red;">/etc/passwd</mark>

We cannot view the passwords for the users in the passwd file because they are encrypted and the passwd file is readable by any user on the system.

All the encrypted passwords for the users are stored in the shadow file. It can be found in the following directory: <mark style="color:red;">/etc/shadow</mark>

The shadow file can only be accessed and read by the root account, this is a very importatnt security feature as it prevents other accounts on the system from accessing the hashed passwords.

* The shadow file gives us information in regards to the hashing algorithm that is being used and the password hash, this is very helpful as we are able to determine the type of hashing algorithm that is being used and its strength. We can determine this by looking at the number after the username encapsulated by the <mark style="color:red;">dollar symbol ($)</mark>.

<figure><img src="../../.gitbook/assets/image (166).png" alt=""><figcaption></figcaption></figure>

## Practice Demo

Enumerate the target.

We find a ftp server running, version <mark style="color:red;">proftpd 1.3.3c</mark>.

We use the module:

* <mark style="color:yellow;">exploit/unix/ftp/proftpd\_133c\_backdoor</mark>

We gain a non-interactive command shell session as the root user.

In this machine, the password has been encrypted with SHA-512 algorithm.

We now upgrade our command shell session to a meterpreter session.

#### De-shadowing the root password hash

* <mark style="color:yellow;">post/linux/gather/hashdump</mark>

It creates a new file with the output from the module.

Use that file with john the ripper.

#### Cracking the hash with John the Ripper

* <mark style="color:yellow;">john --format=sha512crypt 'pathtothefilefromthemodule' --wordlist=/usr/share/wordlists/rockyou.txt</mark>

#### Cracking the hash with hashcat

* <mark style="color:yellow;">hashcat -a3 -m 1800 'pathtohashfile' /usr/share/wordlists/rockyou.txt</mark>
