---
description: https://github.com/411Hall/JAWS
---

# Automating Windows Local Enumeration

In addition to performing local enumeration manually, we can also automate the process with the help of a few scripts and MSF modules.

While local enumeration techniques/commands are important to know, as a pentester, you will need to be time efficient. As a result, you will need to learn how to utilize various automated enumeration scripts.

In addition to automating the process of enumerating information like system information, users & groups etc, these automated enumeration scripts will also provide you with additional information regarding the target system like; privilege escalation vulnerabilties, locally stored passwords etc.

## Windows Local Enum Scripts

<mark style="color:red;">JAWS - Just Another Windows (Enum) Script</mark> - JAWS is PowerShell script designed to help penetration testers (and CTFers) quickly identify potential privilege escalation vectors on Windows systems. It is written using PowerShell 2.0 so 'should' run on every Windows version since Windows 7.

* GitHub Repo: https://github.com/411Hall/JAWS

## Practice Demo

Enumerate the target, exploit the WinRm (port 5985). In this case we already have the credentials to access.

Use the module <mark style="color:red;">expoit/windows/winrm/winrm\_script\_exec.</mark>

Set up the <mark style="color:blue;">RHOSTS, USERNAME,PASSWORD</mark> options.

<mark style="color:blue;">FORCEVBS</mark> to true.

We get a meterpreter 64 bit session with NT AUTHORITY \SYSTEM.

#### Enumerate mounted drives

* <mark style="color:yellow;">show\_mount</mark>

### Post Exploitation Modules

* <mark style="color:yellow;">post/windows/gather/win\_privs</mark>
* <mark style="color:yellow;">post/windodws/gather/enum\_logged\_on\_users</mark>
* <mark style="color:yellow;">post/windows/gather/checkvm</mark>
* <mark style="color:yellow;">post/windows/gather/enum\_applications</mark>
* <mark style="color:yellow;">post/windows/gather/enum\_computers</mark>
* <mark style="color:yellow;">post/windows/gather/enum\_patches</mark>
* <mark style="color:yellow;">post/windows/gather/enum\_shares</mark>

### Using JAWS Script

[https://github.com/411Hall/JAWS/blob/master/jaws-enum.ps1](https://github.com/411Hall/JAWS/blob/master/jaws-enum.ps1)

Clone the github repository or copy the script if you don't have internet connection.

Create a file with "<mark style="color:red;">.ps1</mark>" extension and save the script there.

#### Uploading script to target

Upload it to the "Temp" directory, if it doesn't exist create it at the base of the file system

* <mark style="color:yellow;">mkdir Temp</mark>
* <mark style="color:yellow;">upload 'pathatoscript'</mark>

<mark style="color:purple;">NOTE:</mark> To be able to run the powershell script run (It can take a couple minutes to run, and you might get an error which you can ignore):

* <mark style="color:yellow;">powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt</mark>

Download the file into the attacker machine

* <mark style="color:yellow;">download JAWS-Enum.txt</mark>

