# Banner Grabbing

* Banner grabbing is an information gathering technque used by penetration testers to enumerate information regarding the target operating system as well as the services that are running on its open ports.
* The primary objective of banner grabbing is to identify the service running on a specific port as well as the service version.
* Banner grabbing can be performed through various techniques.
  * Performing a service version detection scan with Nmap.
  * Connecting to the open port with <mark style="color:red;">Netcat</mark>.
  * Authenticating with the service (If the service supports authentication), for examples; <mark style="color:red;">SSH, FTP ,Telnet</mark> etc...

## Practice Demo

Perform a standard service version and OS scan

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

We can see port 22 open, SSH.&#x20;

### Using the NSE for banner grabing

* <mark style="color:yellow;">ls -al /usr/share/nmap/scripts | grep banner</mark>

<figure><img src="../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>

* <mark style="color:yellow;">nmap -sV -p 22 --script=ssh2-enum-algos targetIP:</mark> Checks how many encryption algorithms are supported by the SSH server.
* <mark style="color:yellow;">nmap -sV -p 22 --script=ssh-hostkey --script-args ssh\_hostkey=full targetIP:</mark> Identify the ssh-rsa host key being used by the SSH server
* <mark style="color:yellow;">nmap -sV -p 22 --script ssh-auth-methods --script-args="ssh.user=student" targetIP:</mark> Identify the authentication method being used by the SSH server for user "student"
* <mark style="color:yellow;">nmap -p 22 --script=ssh-run --script-args="ssh-run.cmd=cat /home/student/FLAG,  ssh-run.username=student,ssh-run.password=" targetIP:</mark> Fetches the flag from the defined place

#### Use the script

* <mark style="color:yellow;">nmap -sV --script=banner targetIP</mark>

<figure><img src="../../.gitbook/assets/image (104).png" alt=""><figcaption></figcaption></figure>

It basically gives you the same information as performing a standard service detection scan. <mark style="color:red;">BUT</mark>, some services do show more information with this script.

### Using Netcat

#### Performing banner grabbing on port 22

* <mark style="color:yellow;">nc 'targetIP' 22</mark>

Netcat is more reliable than nmap scripts or service detection.

### Why do banner grabbing?

With the information we can gather from banner grabbing we can use that to search for possible exploits with for example, searchsploit.

In this case:

* <mark style="color:red;">searchsploit openssh 7.2</mark>

### Retrieving banner by authenticating

* <mark style="color:yellow;">ssh root@targetIP</mark>

Sometimes won't reveal anything useful for us.





