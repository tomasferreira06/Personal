# Port Scanning & Enumeration

## Practice Demo

Since we have no information, we check the <mark style="color:red;">/etc/hosts</mark> file to see the IP that translated into the "demo.ine.local" domainname.

Create a folder for the target on the Desktop

### Check for connectivity

Ping the target

Execute a simple version detection nmap scan on the target

<mark style="color:purple;">NOTE:</mark> ALWAYS OUTPUT SCAN RESULTS

Perform deep enumeration:

* Deeper more comprehensive nmap scan
* Banner grabbing
* Explore the services that are running (HTTP Servers etc...)

### Lab Walkthrough for further training

**Step 1:** Open the lab link to access the Kali machine.

<figure><img src="https://assets.ine.com/lab/learningpath/bc370d0abc6b8024c395b0b00543b3672247731584d5dcc40a82bee88cb3de11.png" alt=""><figcaption></figcaption></figure>

**Step 2:** Check if the target machine is reachable:

**Command:**

```
ping -c 4 demo.ine.local
```

<figure><img src="https://assets.ine.com/lab/learningpath/08b9b707796aca0881da317b6bcea5bf7ce74097afb5416e9f9cdabbdd762941.png" alt=""><figcaption></figcaption></figure>

The target is reachable.

**Step 3:** Port scanning with Nmap

We can begin by performing a service detection scan with Nmap on the target system, this can be done by running the following command:

**Command:**

```
nmap -sV demo.ine.local
```

As shown in the following screenshot, we can identify quite a few open ports running different services that could potentially be viable access vectors.

<figure><img src="https://assets.ine.com/lab/learningpath/348caf2d8e6be9e08f332ee8ee2b33d4c177e0967e43cbf4c1822bb3093bc9e9.png" alt=""><figcaption></figcaption></figure>

Now that we have identified the open ports on the target system and the respective services running on them,

we can also perform a Nmap script scan on 10000 ports to get additional information regarding the services running on the open ports.

This can be done by running the following:

**Command:**

```
nmap -T4 -PA -sC -sV -p 1-10000 demo.ine.local
```

**Step 4:** Web Server Enumeration

From the Nmap results, we can identify that port 80 is open and is running the Microsoft IIS 7.5 web server. We can access the target address in a browser to identify whether there is a web app running on the web server.

URL: http://demo.ine.local

<figure><img src="https://assets.ine.com/lab/learningpath/2fdd1c657fdbbc0982301220134898be8a80a7ba673a1fe2de3618931e930d34.png" alt=""><figcaption></figcaption></figure>

The Microsoft IIS 7.5 web server appears to be hosting a simple webpage that displays an image.

The target system is also running a web server with an SSL certificate on port 4844, we can access this by visiting the following URL in a web browser:

URL: https://demo.ine.local:4848

As shown in the following screenshot, it looks like the SSL certificate has expired, as a result, you will need to accept the risk and continue.

<figure><img src="https://assets.ine.com/lab/learningpath/bc4780e5d8db9c3da60f50275426bb4a0d47219fa820df0e326e768a69a51ada.png" alt=""><figcaption></figcaption></figure>

After accepting the SSL security warning, you will be redirected to the web application being hosted on the web server running on port 4848.

As shown in the following screenshot, the web server is running GlassFish.

<figure><img src="https://assets.ine.com/lab/learningpath/7f120dc1afa73f166ad641703b5e78cadc396e771ae7d2859e7f1249c712326a.png" alt=""><figcaption></figcaption></figure>

Another interesting web server is running on port 8484, we can also access this through a browser.

URL: http://demo.ine.local:8484

<figure><img src="https://assets.ine.com/lab/learningpath/fcd903e41b18102ba208b9a86fc22113b53fb6b4396db4870f155425e426a427.png" alt=""><figcaption></figcaption></figure>

As shown in the preceding screenshot, it looks like a Jenkins server is running on this web server.

It also looks like the target system has a WAMP server configured to run on port 8585, accessing this through a browser reveals that this WAMP server hosts a few interesting web apps like WordPress and phpMyAdmin.

URL: http://demo.ine.local:8585

<figure><img src="https://assets.ine.com/lab/learningpath/a710d4bca4930ab32b4540051e0e3f0a7c9a2a8eaf2a6e21542bc1b86404a807.png" alt=""><figcaption></figcaption></figure>

**Step 5:** SMB Enumeration

Given that the target system is running Windows, we can perform enumeration on the SMB port (445) to obtain additional information regarding the exact version of Windows running on the target.

This information can be obtained by running a Nmap service detection and default script scan on port 445 on the target system. This can be done by running the following command:

**Command:**

```
nmap -sV -sC -p 445 demo.ine.local
```

As shown in the screenshot below, the Nmap scan will run various SMB scripts against the target and in this case, we can determine that the target system is running **Windows Server 2008 R2**.

<figure><img src="https://assets.ine.com/lab/learningpath/b46a13771231645e1770e417218f54ed5c637a902cc1dd76049bf575873fb90d.png" alt=""><figcaption></figcaption></figure>

We are also able to obtain the Computer hostname and NetBIOS name.

We can also utilize a Metasploit module to obtain the exact version of SMB running on the target system, this can be used to determine the exact version of Windows running on the target system if the Nmap script scan does not yield results.

We can start the Metasploit Framework Console (msfconsole) by running the following command:

**Command:**

```
msfconsole
```

After starting msfconsole, we can load the following module:

**Command:**

```
use /auxiliary/scanner/smb/smb_version
```

<figure><img src="https://assets.ine.com/lab/learningpath/336b539a218277b59e6747977e9bb352ad7b92c41be3fd06eeb41ebe89dc9bae.png" alt=""><figcaption></figcaption></figure>

After loading the module, we will need to configure the module options. The first option we will need to set is the target address, this can be done by running the following command:

**Command:**

```
set RHOSTS demo.ine.local
```

<figure><img src="https://assets.ine.com/lab/learningpath/18ce67d9cde7c6e88e6b371fca62dab89e01d4d1b1f428229cf36a64a1b417d4.png" alt=""><figcaption></figcaption></figure>

We can now run the module by running the following command:

**Command:**

```
run
```

As shown in the following screenshot, the module reveals that the target system is running **Windows Server 2008 R2**.

<figure><img src="https://assets.ine.com/lab/learningpath/b505918aca8aa1271412cd3a6eb4a8ab4eb72ccb70286e71290b9867d92f4cd6.png" alt=""><figcaption></figcaption></figure>

This information is very useful as it can be used to identify specific vulnerabilities within the exact version of Windows running on the target system.

## Conclusion

In this lab, we explored the process of performing a port scan and enumerating information from a Windows target, to identify potentially interesting services that can provide us with an initial access vector.

