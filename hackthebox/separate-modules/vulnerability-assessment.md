# Vulnerability Assessment

## Vulnerability Assessment

A **Vulnerability Assessment** aims to identify and categorize risks for security weaknesses related to assets within an environment. It is important to note that there is little to no manual exploitation during a vulnerability assessment. It also provides remediation steps to fix the issues.

The purpose of a Vulnerability Assessment is to understand, identify, and categorize the risks for more apparent issues present in an environment without actually exploiting them. Depending on the scope of the assessment, some customers may ask us to validate as many vulnerabilities as possible by performing minimally invasive exploitation to confirm scanner findings and rule out false positives. Other customers will ask for a report of all findings identified by the scanner.

As with any assessment, it is essential to clarify the scope and intent before starting. Vulnerability management helps organizations identify the weak points in their assets, understand the risk level, and prioritize remediation efforts.

**Key Consideration:** Organizations should always test substantial patches before deploying them into their environment to prevent disruptions.

### Methodology

Most organizations follow a similar vulnerability assessment methodology. While slight variations may occur, the main steps generally include:

1. Identifying assets
2. Scanning for vulnerabilities
3. Classifying vulnerabilities
4. Creating a remediation plan

### Key Terms

#### Vulnerability

A **Vulnerability** is a weakness or bug in an organization's environment, including applications, networks, and infrastructure, that opens up the possibility of threats from external actors.

Vulnerabilities are often registered through MITRE's Common Vulnerability Exposure (CVE) database and scored using the **Common Vulnerability Scoring System (CVSS)** to determine severity. This helps prioritize resources and determine how to respond to a given threat.

#### Threat

A **Threat** is a process that amplifies the potential of an adverse event, such as a threat actor exploiting a vulnerability.

#### Exploit

An **Exploit** is any code or resource used to take advantage of a weakness. Many exploits are available through open-source platforms like Exploit-db or Rapid7's Vulnerability and Exploit Database.

#### Risk

**Risk** is the possibility of assets or data being harmed or destroyed by threat actors.

To summarize:

* **Risk**: Something bad that could happen
* **Threat**: Something bad that is happening
* **Vulnerability**: Weaknesses that could lead to a threat

### Asset Management

Effective asset management starts with creating an **inventory of data assets**. Organizations must understand what they are protecting in order to deploy proper defenses.

#### Asset Inventory

An asset inventory includes:

* IT, operational technology, and physical assets
* Software, mobile, and development assets
* Data classification to ensure security and access control

#### Application and System Inventory

This includes:

* On-premises data (e.g., HDDs, SSDs, servers)
* Data stored in cloud providers (AWS, GCP, Azure)
* Data stored in SaaS applications (Google Drive, Dropbox)
* On-premises networking devices (routers, firewalls)

Organizations must ensure that any changes to data assets are thoroughly noted to maintain an up-to-date inventory.



## Assessment Standards

Both penetration tests and vulnerability assessments must comply with specific standards to be accredited and accepted by governments and legal authorities. These standards ensure assessments are thorough and follow generally accepted practices, increasing efficiency and reducing the likelihood of an attack.

### Regulatory Compliance Bodies

Each regulatory body has its own information security standards for organizations to maintain accreditation. The major players in compliance include PCI, HIPAA, FISMA, and ISO 27001.

#### Payment Card Industry Data Security Standard (PCI DSS)

The **Payment Card Industry Data Security Standard (PCI DSS)** is a widely known standard for organizations handling credit card data. While not a government regulation, organizations that store, process, or transmit cardholder data (e.g., banks, online retailers) must implement PCI DSS guidelines. PCI DSS includes internal and external scanning of assets.

One key requirement is maintaining a **Cardholder Data Environment (CDE)**, which must be segmented from normal assets to protect cardholder data during an attack.

#### Health Insurance Portability and Accountability Act (HIPAA)

**HIPAA** (Health Insurance Portability and Accountability Act) is designed to protect patient data. Although vulnerability assessments are not explicitly required, HIPAA mandates risk assessments and vulnerability identification to maintain accreditation.

#### Federal Information Security Management Act (FISMA)

The **Federal Information Security Management Act (FISMA)** governs the protection of government operations and information. It requires organizations to maintain a vulnerability management program to ensure availability, confidentiality, and integrity.

#### ISO 27001

**ISO 27001** is an internationally recognized standard for information security management. Organizations seeking ISO 27001 accreditation must conduct internal and external scans regularly and maintain an effective **Information Security Management System (ISMS)**.

### Penetration Testing Standards

Penetration testing should follow specific rules and guidelines. A clearly defined scope is essential, and pentesters must have a legal agreement with the client specifying what actions are permitted. Pentesters should minimize changes to systems and data during tests, using screenshots or other non-invasive methods instead of removing sensitive information.

#### PTES (Penetration Testing Execution Standard)

The **Penetration Testing Execution Standard (PTES)** outlines the phases of a penetration test and applies to all types of tests. The sections of PTES include:

* Pre-engagement Interactions
* Intelligence Gathering
* Threat Modeling
* Vulnerability Analysis
* Exploitation
* Post Exploitation
* Reporting

#### OSSTMM (Open Source Security Testing Methodology Manual)

**OSSTMM** is another pentesting standard that covers various areas, including:

* Human Security (e.g., social engineering)
* Physical Security
* Wireless Communications (e.g., WiFi, Bluetooth)
* Telecommunications
* Data Networks

#### NIST (National Institute of Standards and Technology)

**NIST** offers a Penetration Testing Framework and is well known for the **NIST Cybersecurity Framework**. The phases of the NIST pentest framework are:

* Planning
* Discovery
* Attack
* Reporting

#### OWASP (Open Web Application Security Project)

**OWASP** is the go-to organization for web application security standards and risk classification. OWASP maintains various testing standards, including:

* **Web Security Testing Guide (WSTG)**
* **Mobile Security Testing Guide (MSTG)**
* **Firmware Security Testing Methodology**

These standards help ensure thorough and effective penetration testing while adhering to industry best practices.



## Common Vulnerability Scoring System (CVSS)

Vulnerability severity ratings can be calculated using various systems, one of the most common being the **Common Vulnerability Scoring System (CVSS)**. Many vulnerability scanners automatically assign these scores to findings, but it's essential to understand how the scores are derived for manual calculations or justifications. Another system often used alongside CVSS is **Microsoft DREAD**, a risk assessment model developed by Microsoft for evaluating the severity of security threats.

### Microsoft DREAD

The **DREAD** model calculates risk based on five main factors:

* **Damage Potential**: How severe would the damage be if the threat were exploited?
* **Reproducibility**: How easily can the threat be reproduced?
* **Exploitability**: How easily can the threat be exploited?
* **Affected Users**: How many users would be affected by the exploit?
* **Discoverability**: How easily can the vulnerability be discovered?

DREAD uses a scale of 10 points to evaluate these factors, which is then used to prioritize threats and vulnerabilities for remediation.

### CVSS

The **Common Vulnerability Scoring System (CVSS)** helps categorize the risk associated with vulnerabilities and prioritizes them based on severity ratings. The CVSS score consists of metrics that measure both **exploitability** and **impact**.

#### Base Metric Group

The **Base Metric Group** represents the inherent characteristics of the vulnerability. It is divided into **Exploitability Metrics** and **Impact Metrics**.

**Exploitability Metrics**

* **Attack Vector**: How the vulnerability can be exploited (e.g., network, adjacent, local, physical).
* **Attack Complexity**: How difficult it is to exploit the vulnerability.
* **Privileges Required**: What level of privilege is needed to exploit the vulnerability.
* **User Interaction**: Whether user interaction is required for exploitation.

**Impact Metrics**

Impact metrics are based on the **CIA triad**:

* **Confidentiality**: Measures unauthorized access to information.
* **Integrity**: Measures unauthorized modification of data.
* **Availability**: Measures the disruption of service.

#### Temporal Metric Group

The **Temporal Metric Group** considers the current state of the vulnerability in terms of exploit availability and remediation efforts.

* **Exploit Code Maturity**: How easy it is to exploit the vulnerability (e.g., Not Defined, High, Functional, Proof-of-Concept, Unproven).
* **Remediation Level**: The current state of fixes for the vulnerability (e.g., Official Fix, Workaround, Temporary Fix).
* **Report Confidence**: The accuracy and reliability of vulnerability details (e.g., Confirmed, Reasonable, Unknown).

#### Environmental Metric Group

The **Environmental Metric Group** adjusts the score based on the organization's specific environment and needs, considering the unique impact on **Confidentiality**, **Integrity**, and **Availability**. This group includes:

* **Modified Base Metrics**: Customizable values based on an organization's environment (e.g., High, Medium, Low).

### CVSS Calculation Example

CVSS scores are calculated by combining these metrics. For example, a vulnerability like the **Windows Print Spooler Remote Code Execution Vulnerability** might have a CVSS Base Metric score of 8.8. This score would consider factors such as attack vector, attack complexity, and impact on confidentiality, integrity, and availability.

The National Vulnerability Database provides a public calculator to perform these calculations.



## Common Vulnerabilities and Exposures (CVE)

### Open Vulnerability Assessment Language (OVAL)

**Open Vulnerability Assessment Language (OVAL)** is an international standard used to assess and describe the state of a system. Co-supported by the U.S. Department of Homeland Security's Cybersecurity and Communications Office, OVAL provides a language for encoding system attributes and creates content repositories shared across the security community. OVAL definitions are written in XML format and provide over 7,000 definitions for public use. It also integrates with **NIST's Security Content Automation Protocol (SCAP)**, streamlining vulnerability management and policy compliance.

### OVAL Process

The OVAL assessment process consists of three steps:

1. **Identify system configurations for testing**
2. **Evaluate the system's current state**
3. **Disclose the findings in a report**

The report can classify the system in several states, such as **Vulnerable**, **Non-compliant**, **Installed Asset**, or **Patched**.

<figure><img src="../../.gitbook/assets/image (245).png" alt=""><figcaption></figcaption></figure>

### OVAL Definitions

OVAL definitions help identify software vulnerabilities, misconfigurations, and system details without direct exploitation. The four primary classes of OVAL definitions include:

* **OVAL Vulnerability Definitions**: Identifies system vulnerabilities
* **OVAL Compliance Definitions**: Ensures configurations meet policy requirements
* **OVAL Inventory Definitions**: Identifies specific software on a system
* **OVAL Patch Definitions**: Confirms if a system has the appropriate patch

Each OVAL ID follows a unique format: `oval:Organization Domain Name:ID Type:ID Value`. Examples include definition (`def`), object (`obj`), state (`ste`), and variable (`var`).

Security scanners like Nessus utilize OVAL to create security compliance templates.

***

## Common Vulnerabilities and Exposures (CVE)

**Common Vulnerabilities and Exposures (CVE)** is a public catalog of security issues, sponsored by the U.S. Department of Homeland Security (DHS). Each security issue receives a unique CVE ID assigned by a **CVE Numbering Authority (CNA)**. CVEs provide critical information about vulnerabilities, helping IT teams understand the severity and impact of an issue.

<figure><img src="../../.gitbook/assets/image (246).png" alt=""><figcaption></figcaption></figure>

### CVE Assignment Process

The CVE assignment process consists of nine stages:

1. **Identify if CVE is Required**: Determine if the issue qualifies as a vulnerability that negatively impacts **Confidentiality**, **Integrity**, or **Availability**.
2. **Reach Out to Vendor**: Ensure a good faith effort is made to contact the vendor.
3. **Determine if Vendor or Third-Party CNA Is Needed**: Contact the vendor or third-party CNA if applicable.
4. **Request CVE ID via Web Form**: Submit a CVE request using the CVE web form.
5. **Confirmation of CVE Form**: Receive confirmation of submission.
6. **Receive CVE ID**: If approved, receive a CVE ID.
7. **Public Disclosure**: Ensure appropriate vendors and parties are aware before public disclosure.
8. **Announce CVE**: Share CVEs appropriately, ensuring different vulnerabilities are tracked separately.
9. **Provide Information to CVE Team**: Help provide additional details to the CVE team for inclusion in the public listing, which is maintained in the **National Vulnerability Database (NVD)**.

***

## Responsible Disclosure

**Responsible Disclosure** is critical to the security community, ensuring vendors are informed of vulnerabilities before public announcement, allowing them time to release patches. Disclosing issues responsibly prevents attackers from leveraging the vulnerabilities in so-called **zero-day (0-day)** attacks.

***

### Examples of CVEs

* **CVE-2020-5902**: A remote code execution vulnerability in **BIG-IP Traffic Management User Interface (TMUI)** that allows attackers to take over a system.
* **CVE-2021-34527 (PrintNightmare)**: A Windows Print Spooler service vulnerability that allows remote code execution and full system takeover by authenticated users.



















































































































